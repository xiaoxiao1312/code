<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>小米账号-登录</title>
    <link rel="shortcut icon" href="http://s01.mifile.cn/favicon.ico">
    <link rel="stylesheet" href="../css/iconfont.css">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/login.css">
    <script src="../js/login.js"></script>
</head>
<body>
    <header>
        <section class="header container">
        <div class="login">
            <a href="./index.html">小米网站</a>
        </div>
        </section>
    </header>
<!-- 图片 -->
    <section class="banner">
        <div class="wrap container">
            <!-- 表单输入登录 -->
            <div class="main_content">
                <div class="layout">
                    <div class="content_top">
                        <a href="#">账号登录</a>
                        <i class="span">|</i>
                        <a href="#">扫码登录</a>
                    </div>
                    <form class="input_box" action="./index.html">
                        <input type="text" name="" id="username" placeholder="邮箱/手机号码/小米ID" value="935774819" oninput="checkUsername()">
                        <span>用户名必须是6-13位的字母数字或者下划线</span>
                        <input type="password" name="" id="password" placeholder="密码" value="123456789" oninput="checkPassword()">
                        <span>密码必须是8-16的字母,数字或者特殊符号</span>
                    
                    <div class="btn_big">
                        <a href="#"><input type="submit" id="login_button" value="登录"></a>
                    </div>
                </form>
                    <div class="register_way">
                    <a href="register.html">手机短信登录/注册</a>
                    <a href="#">立即注册</a>
                    <span>|</span>
                    <a href="#">忘记密码？</a>
                    </div>
                    <div class="login_way">
                        <a href="#"><i class="iconfont iconQQ"></i></a>
                        <a href="#"><i class="iconfont iconweibo"></i></a>
                        <a href="#"><i class="iconfont iconzhifubao"></i></a>
                        <a href="#"><i class="iconfont iconweixin"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </section>
<!-- 底部 -->
    <footer>
        <div class="footer container">
            <ul>
                <li><a href="#">简体</a><span>|</span></li>
                <li><a href="#">繁体</a><span>|</span></li>
                <li><a href="#">English</a><span>|</span></li>
                <li><a href="#">常见问题</a><span>|</span></li>
                <li><a href="#">隐私政策</a></li>
            </ul>
            <p>小米公司版权所有-京ICP备10046444-京公网安备11010802020134号-京(CP证110507号</p>
        </div>
    </footer>


    <script src="../js/cookie.js"></script>
    <script>
        var un = getCookie('uername');
        if(un){
            location.href="./cart.html";
        }
        // 通过页面上绑定事件的方式获取用户填写的用户名和密码
        var unInp = document.querySelectorAll('input')[0];//用户名输入框
        var pwInp = document.querySelectorAll('input')[1];//密码输入框
        var loginBtn = document.querySelectorAll('input')[2];//登录按钮
        // 当用户点击登录时候
        loginBtn.onclick = function(){
            // 把用户名和密码传递给后端
            // 创建ajax对象
            var xhr = new XMLHttpRequest()
            // 配置请求信息
            xhr.open('POST','../interface/login.php');
            // 接收响应
            xhr.onload = function(){
                // console.log(xhr.responseText)
                // 登录成功跳转购物车，登录失败告诉用户
                var json = JSON.parse(xhr.responseText);
                if(json.code==1){
                    location.href = "./cart.html"
                }else{
                    document.querySelector('h1').innerHTML = "登录失败"
                }
            }
            // 发送请求之前，设置请求头
            xhr.setRequestHeader('content-type','application/x-www-form-urlencoded');
            // 发送请求
            xhr.send(`username=${unInp.value}&password=${pwInp.value}`);// 回忆es6的模板字符串
        }


    </script>
</body>
</html>